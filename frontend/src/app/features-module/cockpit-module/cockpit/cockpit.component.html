<!-- Copyright (C) 2016 Linagora

This program is free software: you can redistribute it and/or modify
it under the terms of the GNU Affero General Public License as
published by the Free Software Foundation, either version 3 of the
License, or (at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU Affero General Public License for more details.

You should have received a copy of the GNU Affero General Public License
along with this program.  If not, see <http://www.gnu.org/licenses/>. -->

<div layout="column" class="sidenav-menu" [class.cockpit-theme]="config?.isDarkTheme">
  <md-sidenav-layout fullscreen>
    <md-sidenav #start mode="over" (close)="closeSidenav()" [class.sidenav-no-workspace-selected]="!workspace.id">

      <md-card id="header-sidenav">
        <img class="logo-petals" src="assets/img/logo_petalscockpit.png">
        <md-card-title-group>

          <button md-icon-button routerLink="/cockpit/workspaces/settings" (click)="closeSidenav()">

            <md-icon>settings</md-icon>
          </button>
          <span flex></span>
          <p>{{ user.name }}</p>
          <span flex></span>
          <button md-icon-button [disabled]="user.isDisconnecting" class="icon-power" (click)="disconnectUser()">
            <md-icon *ngIf="!user.isDisconnecting">power_settings_new</md-icon>
            <md-progress-circle *ngIf="user.isDisconnecting" mode="indeterminate"></md-progress-circle>
          </button>
        </md-card-title-group>
      </md-card>

      <!-- do not separate the buttons otherwise there's a space between them -->
      <div class="wrapper-workspace-name">
        <button
          class="workspace-name"
          md-raised-button
          *ngIf="workspace.name"
          color="accent"
          (click)="closeSidenav()"
          [routerLink]="['workspaces', workspace.id]"
        >
          {{ workspace.name }}
        </button><button
          class="change-workspace"
          md-raised-button
          *ngIf="workspace.name"
          color="accent"
          (click)="closeSidenav()"
          [routerLink]="['workspaces']"
        >
          <md-icon>view_list</md-icon>
        </button>
      </div>

      <div *ngIf="!workspace.id" class="info no-workspace-selected">
        No workspace selected<br>
        Please select one
      </div>

      <md-tab-group
        layout="row"
        #tabGroup
        *ngIf="workspace.id"
        [selectedIndex]="tabSelectedIndex"
        (focusChange)="openTab(tabGroup.selectedIndex)"
      >
        <md-tab label="Petals" class="md-tab-petals">
          <app-petals-menu-module></app-petals-menu-module>
        </md-tab>

        <md-tab label="Service" class="md-tab-service">
          <app-service-menu-module></app-service-menu-module>
        </md-tab>

        <md-tab label="API" class="md-tab-api">
          <app-api-menu-module></app-api-menu-module>
        </md-tab>
      </md-tab-group>
    </md-sidenav>

    <router-outlet></router-outlet>
  </md-sidenav-layout>
</div>
