<!-- Copyright (C) 2016 Linagora

This program is free software: you can redistribute it and/or modify
it under the terms of the GNU Affero General Public License as
published by the Free Software Foundation, either version 3 of the
License, or (at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU Affero General Public License for more details.

You should have received a copy of the GNU Affero General Public License
along with this program.  If not, see <http://www.gnu.org/licenses/>. -->

<div class="sidenav-menu" [class.cockpit-theme]="config?.isDarkTheme">
  <md-sidenav-layout fullscreen>
    <md-sidenav #sidenav align="start" mode="side" opened="true">

      <md-card id="header-sidenav">
        <img class="logo-petals" src="/assets/img/logo_petalscockpit.png">
        <md-card-title-group>
          <button md-icon-button routerLink="/cockpit/workspaces/settings">
            <md-icon>settings</md-icon>
          </button>

          <p>{{ user.name }}</p>

          <button md-icon-button [disabled]="user.isDisconnecting" class="icon-power" (click)="disconnectUser()">
            <md-icon *ngIf="!user.isDisconnecting">power_settings_new</md-icon>
            <md-progress-circle *ngIf="user.isDisconnecting" mode="indeterminate"></md-progress-circle>
          </button>
        </md-card-title-group>
      </md-card>

      <button
        class="change-workspace" md-raised-button color="accent"
        [routerLink]="['workspaces', (workspace && workspace.id ? workspace.id : '' )]"
      >
        {{ 'CHANGE_WORKSPACE' | translate }}
      </button>

      <md-tab-group
        #tabGroup
        *ngIf="workspace.id && tabSelectedIndex !== -1"
        [selectedIndex]="tabSelectedIndex"
        (selectChange)="openTab(tabGroup.selectedIndex)"
      >
        <md-tab>
          <template md-tab-label>Petals</template>
          <template md-tab-content>
            <app-petals-menu-module></app-petals-menu-module>
          </template>
        </md-tab>

        <md-tab>
          <template md-tab-label>Service</template>
          <template md-tab-content>
            <app-service-menu-module></app-service-menu-module>
          </template>
        </md-tab>

        <md-tab>
          <template md-tab-label>API</template>
          <template md-tab-content>
            <app-api-menu-module></app-api-menu-module>
          </template>
        </md-tab>
      </md-tab-group>
    </md-sidenav>

    <router-outlet></router-outlet>
  </md-sidenav-layout>
</div>
